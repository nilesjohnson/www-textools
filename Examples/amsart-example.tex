\documentclass[amssymb,amsfonts]{amsart}
\usepackage{amssymb, latexsym}
\usepackage[T1]{fontenc}
% So that the accented characters are dealt with correctly
%\usepackage[intlimits,sumlimits,noDcommand,narrowiints]{kpfonts}
\usepackage[english]{babel}
%\usepackage{microtype}
%\usepackage{svn}
\usepackage[notref,notcite]{showkeys}
%\usepackage{changes}
% The changes package allows editing marks (addition, deletion,
% replacement) with attribution to author(s). See CTAN
%\usepackage{empheq}
% Empheq 'emphasizes equations', and gives a visual markup extension
% to amsmath. In particular you can have a left braced set of
% equations number individually. See CTAN for details
%\usepackage{tensor}
% The tensor package allows left indices and auto-justified/spaced
% sub/super scripts. See Documentation in CTAN
%\usepackage{bbm}
% Provides blackboard characters for other than upper-case latin
%\usepackage{constants}
% Constants provide a way to automatically number constant/error
% terms.
%\usepackage[pdfusetitle]{hyperref}
% Remember to replace when done!
%\usepackage{www_math_commands}


\title[short title]{long title}
\author[WWY Wong]{Willie Wai Yeung Wong}
%\address{Michigan State University}
\thanks{other thanks}
\thanks{\GitPageFooter}
%\email{wongwwy@member.ams.org}
%\subjclass[2000]{MSC, look up on AMS}


\makeatletter

%\RequirePackage[T1]{fontenc}
%\RequirePackage[english]{babel}

\RequirePackage{ifthen}

\RequirePackage{geometry}
%\RequirePackage[pagestyles]{titlesec}
\RequirePackage{everypage}
\RequirePackage{etoolbox}
\RequirePackage{newfile}
%\RequirePackage{emarks}
\RequirePackage{refcount}
\RequirePackage{marginfix}
\RequirePackage{titling}

\RequirePackage{enumitem}
\RequirePackage{index}
\RequirePackage{url}
%\RequirePackage[backend=biber,style=reading,entrykey=false,abstract=false,library=false,file=false,maxnames=10]{biblatex}


%\RequirePackage[oldstylenums,narrowiints,intlimits,sumlimits,noDcommand]{kpfonts}


%\RequirePackage{mathtools}
%\RequirePackage[ntheorem]{empheq}
%\RequirePackage[amsmath,thmmarks,thref,hyperref]{ntheorem}

\RequirePackage[colorlinks=false]{hyperref}

%% Geometry (geometry)
\geometry{papersize={7.4in,9.5in},includemp=true,marginparwidth=1.44in,width=6.1in,bindingoffset=0.2in,twoside,hmarginratio={2:1},vmarginratio={3:4},headheight=14pt,headsep=0.2in,footskip=0.5in}

%% Git backup (gracefully degrades if user doesn't use Git)
\newcommand*\gitShortHash{(git not used)}
\newcommand*\GitPageFooter{(version info not available)}




% %%%%% Theorem like environments (ntheorem (modified)) %%%%%
% %\numberwithin{equation}{chapter}

% \theoremstyle{changebreak}
% \theoremheaderfont{\normalfont\scshape\bfseries}
% \theorembodyfont{\upshape}
% \theoremseparator{}
% \theoremindent0cm
% \theoremnumbering{arabic}
% \theoremsymbol{\ensuremath{\blacksquare}}

\newtheorem{thm}[equation]{Theorem}
\newtheorem{prop}[equation]{Proposition}
\newtheorem{lem}[equation]{Lemma}
\newtheorem{cor}[equation]{Corollary}
\newtheorem{defn}[equation]{Definition}
\newtheorem{conv}[equation]{Convention}

%\theorembodyfont{\itshape}
%\theoremsymbol{\ensuremath{\diamondsuit}}

\newtheorem{quest}[equation]{Open Question}
\newtheorem{conj}[equation]{Conjecture}

%\theoremheaderfont{\normalfont\itshape}
%\theorembodyfont{\upshape}
%\theoremsymbol{\ensuremath{\blacksquare}}

\newtheorem{rmk}[equation]{Remark}
\newtheorem{exa}[equation]{Example}
\newtheorem{exer}[equation]{Exercise}

%\theoremstyle{nonumberplain}
%\theoremheaderfont{\normalfont\scshape}
%\theoremsymbol{\ensuremath{\square}}

%\newtheorem{proof}{Proof}

\newenvironment{pfof}[1]%
	{\def\wwwnotes@pfofctr{#1}\begin{proof}}%
	{\end{proof}}

% \newtheoremstyle{wwwnumberonly}%
%   {\item[\theorem@headerfont\bfseries\hskip\labelsep ##2]}%
%   {\item[\theorem@headerfont\bfseries\hskip\labelsep ##2 (##3)]}
%\theoremstyle{wwwnumberonly}
%\theoremheaderfont{\normalfont\bfseries}
%\theoremsymbol{\P}
%\theorempreskip\parsep
%\theorempostskip\parsep

%\newtheorem{thot}[equation]{Thought}
%%%%% End Theorem like environments %%%%%

%%%%% Margin Notes and Descriptive Labelling (marginfix, everypage, newfile, refcount, ntheorem, amsmath) %%%%%
\newcommand*\marginfont{\footnotesize\itshape}
\setlength\marginparpush{9pt}
\newcommand{\marginnote}[1]{%
	\marginpar[\raggedleft\marginfont #1]{\raggedright\marginfont #1}}

\newoutputstream{Xrefedges}
\newoutputstream{Xrefvertices}
\openoutputfile{\jobname-edges-xrf.csv}{Xrefedges}
\openoutputfile{\jobname-vertices-xrf.csv}{Xrefvertices}
\addtostream{Xrefedges}{source,target}
\addtostream{Xrefvertices}{id,label,type,description,page}

\newcommand\label@getdesc[5]{%
	\ifcsname www@label@store@description@#1\endcsname
		#2{#4\@nameuse{www@label@store@description@#1}#5}%
	\else
		#3%
	\fi}

\AddEverypageHook{\gdef\@desc@refs@on@page{}}
%%%%% End Margin Notes and Descriptive Labelling %%%%%



%\renewcommand{\ref}[1]{\OLDref{#1}\showdesc{#1}\writeref{#1}}



\makeatother






\usepackage{lipsum}


%%% In the code below author is not the same as the person making the
%%% committ; see http://git-scm.com/docs/git-commit option --author
%%% for more information
\begingroup
\catcode`\%=12
\catcode`\$=12
\gdef\gitAuthorEmail{\url{$Format:%aE$}}
\gdef\GitPageFooter{$Format: v:\texttt{%h %d}; last edit: %aN on %ai.$}
\endgroup


%\renewcommand{label}[1]{\desclabel{#1}{#1}}

\begin{document}

\let\bareref\ref
\let\barelabel\label
\makeatletter
\newcommand*\writevertex[1]{
  \addtostream{Xrefvertices}{#1,"\getrefnumber{#1}","Label","#1",\getpagerefnumber{#1}}}
\newcommand*\writeref[1]{\ifdef\wwwnotes@pfofctr{
  \writevertex{\wwwnotes@pfofctr}
  \writevertex{#1}
  \addtostream{Xrefedges}{\wwwnotes@pfofctr,#1}
}{}}
\renewcommand*\ref[1]{\bareref{#1}\writeref{#1}}
 

\makeatother

\begin{abstract}
\end{abstract}




\maketitle




\section{First section}

\lipsum[1-2]

\begin{align}\label{eqA}
C &= D \\
C' &= D' \label{eq001}
\end{align}

\ref{eq001} 

\begin{subequations}
\begin{align}
E &= F \label{eq002}\\
E' &= F' \label{eq003}
\end{align}

some text

\begin{equation}\label{eq1}
	A = B
\end{equation}
\end{subequations}

\begin{prop}\label{someprop}
   Text
\end{prop}

\begin{thm}\label{thm1}
	\lipsum[27]

	test
\end{thm}

\lipsum[1]

\begin{pfof}{thm1}
THis is how it goes.
\begin{lem}[Step 1]\label{parastep}
	\lipsum[9-10]

	And this is sufficient.
\end{lem}
Then we can apply \ref{eq1} and \ref{someprop} to get the final answer.
Here ends the proof.
\end{pfof}

\begin{rmk}\label{rmk1}
	\lipsum[27]

	test
\end{rmk}

\begin{cor}\label{cor1}
	\lipsum[24]

	text
\end{cor}

\begin{pfof}{cor1}
	By using \ref{rmk1}\writeref{rmk1}, we see that \ref{eq1} in fact implies something else. Thus the arguments in \ref{parastep} is in fact good enough to show the strengthened results. 
\end{pfof}

\begin{equation}
	C = D
\end{equation}

\section{A section on techniques}

Before doing anything else, let us recall \ref{thm1}. Also let's try \ref{parastep}.

\lipsum[2]

\begin{equation}
	A = B
\end{equation}

\lipsum[3-8]



%\section{Another section}

\lipsum[5-9]

Some text \cite{Wong2009}.


\section{Second section}


\lipsum[10-23]

\begin{equation}
K = \frac12 mv^2
\end{equation}

This is it.


\bibliographystyle{amsalpha}
\bibliography{mixmaster.bib}

\end{document}
